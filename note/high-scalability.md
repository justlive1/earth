网站的伸缩性架构

---

	系统能够通过增加(减少)自身资源规模的方式增强(减少)自己计算处理事务的能力。如果这种增减比例是成正比的，就被称作线性伸缩性。在网站架构中，通常指利用集群的方式增加服务器数量、提高系统的整体事务吞吐能力。


# 网站架构的伸缩性设计

- 不同功能进行物理分离实现伸缩
	- 单一服务器 -> 数据库分离 -> 缓存分离 -> 静态资源分离
	- 纵向分离 (分层后分离) 将业务处理流程上不同部分分离部署
	- 横向分离 (业务分割后分离) 将不同的业务模块分离部署

- 单一功能通过集群规模实现伸缩

# 应用服务器集群的伸缩性设计

- HTTP重定向负载均衡
- DNS域名解析负载均衡
- 反向代理负载均衡
- IP负载均衡
- 数据链路层负载均衡
- 负载均衡算法
	- 轮询
	- 加权轮询
	- 随机
	- 最少连接
	- 源地址散列

# 分布式缓存集群的伸缩性设计

- Memcached
	- 应用程序 -> 路由 -> Node
	- 余数Hash 扩容时的路由重分配
- 分布式缓存一致性Hash算法
	- 一致性Hash环
	- 构造长度为2^32的整数环，根据节点名称的Hash值(分布范围[0,2^32-1])放置在这个环上
	- 增加虚拟节点增加各个物理节点的负载均衡 (一般设置150个)

# 数据存储服务器集群的伸缩性设计

- 关系型数据库集群的伸缩性设计
	- 数据复制
	- Amoeba
	- Cobar 分布式关系数据库访问代理
		- Cobar服务器集群的伸缩
			- 负载均衡
		- Mysql服务器集群的伸缩
			- 数据迁移
			- 以Schema为单位迁移
		- 只支持单一数据库实例上处理查询请求，无法执行跨库JOIN 和 事务管理
	- 避免事务或利用事务补偿机制代替数据库事务
	- 分解数据访问逻辑避免JOIN操作

- NoSQL数据库的伸缩性设计
	- 非关系型的、分布式数据库设计模式
	- 一般都放弃了以关系代数为基础的结构化查询语句(SQL)和事务一致性保证(ACID)
	- 强化高可用性和伸缩性
	- HBase
		- 其伸缩性主要依赖可分裂的HRegion和可伸缩的分布式文件系统HDFS
		- 应用程序 -> Zookeeper -> HMaster -> HRegionServer -> HRegion 